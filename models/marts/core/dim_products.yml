 version: 2

models:
  - name: dim_products
    description: "tabla que nos muestra información sobre los productos"
    tests:
    - dbt_expectations.expect_table_row_count_to_be_between:
        max_value: 30
    columns:
      - name: product_detail_id
        description: "PK de la tabla int_products, identifica de manera única cada detalle de producto"
        tests:
              - relationships:
                  to: ref('int_products')
                  field: product_detail_id

      - name: product_id
        description: "PK de la tabla products, identifica de manera unica cada producto"

      - name: product_name
        description: "nombre del producto"

      - name: product_unit_cost_usd
        description: "coste unitario del producto, en dólares"

      - name: price_usd
        description: "precio de venta del producto, en dólares"

      - name: gama_producto
        description: "nos muestra a qué gama pertenece el producto, la gama se asigna dependiendo del precio de venta del producto"
        tests:
          - accepted_values:
              values: ['Alta','Media','Baja']

      - name: valid_from
        description: "nos muestra desde qué fecha el registro está activo"

      - name: valid_to
        description: "nos muestra hasta qué fecha el registro está activo"

      - name: sync_date
        description: "fecha de sincronización"

      - name: sync_time
        description: "hora de sincronización"